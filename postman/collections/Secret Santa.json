{
	"info": {
		"_postman_id": "c851c977-7d66-4341-b132-bbe34fa39238",
		"name": "Secret Santa",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_uid": "23365433-c851c977-7d66-4341-b132-bbe34fa39238"
	},
	"item": [
		{
			"name": "Scenario 1",
			"item": [
				{
					"name": "Login (wrong email & pass)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 404\", function () {\r",
									"  pm.response.to.have.status(404);\r",
									"});\r",
									"    \r",
									"const error = pm.response.json().error;\r",
									"\r",
									"pm.test (\"Returns expected error response\", () => {\r",
									"  pm.expect(error.message).to.eql(\"USER_NOT_FOUND\");\r",
									"  pm.expect(error.name).to.eql(\"NotFoundError\");\r",
									"  pm.expect(error.type).to.eql(\"server\");\r",
									"  pm.expect(error.data).to.be.null;\r",
									"  pm.expect(error.status).to.eql(404);\r",
									"  pm.expect(error.errors).to.include(\"USER_NOT_FOUND\");\r",
									"});"
								],
								"type": "text/javascript",
								"id": "02c0243d-9326-4ac4-a4a4-4df881066cbe"
							}
						}
					],
					"id": "db8b20e7-b934-4605-831f-f3153bae954f",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"email\": \"Oksana@gmail.com\",\r\n    \"password\": \"ngmgfsmsmsmgfs\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/login?redirect=%2F",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"login"
							],
							"query": [
								{
									"key": "redirect",
									"value": "%2F"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Login (success)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"id": "1b77015c-a302-4cac-8799-5557301e556f"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"const response = pm.response.json()\r",
									"    \r",
									"pm.test (\"Login success\", () => {\r",
									"  pm.expect(response.email).to.eql(\"deminaon@gmail.com\");\r",
									"  pm.expect(response.username).to.eql(\"Oksana\");\r",
									"});"
								],
								"type": "text/javascript",
								"id": "a5555cc8-a773-4b41-9064-334313f73d4b"
							}
						}
					],
					"id": "588491cd-7c2f-4ac2-91ab-6f155988c104",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"email\": \"Deminaon@gmail.com\",\r\n    \"password\": \"qwerty123\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/login?redirect=%2F",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"login"
							],
							"query": [
								{
									"key": "redirect",
									"value": "%2F"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Password change (password is more then 20)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {\r",
									"  pm.response.to.have.status(400);\r",
									"});\r",
									"\r",
									"const error = pm.response.json().error;\r",
									"\r",
									"pm.test(\"Returns expected error response\", () => {\r",
									"  pm.expect(error.message).to.eql(\"validations.invalid\");\r",
									"  pm.expect(error.name).to.eql(\"ValidationError\");\r",
									"  pm.expect(error.type).to.eql(\"server\");\r",
									"  pm.expect(error.data).to.be.null;\r",
									"  pm.expect(error.status).to.eql(400);\r",
									"  pm.expect(error.errors[0].transKey).to.eql(\"validations.maxCharLength\");\r",
									"  pm.expect(error.errors[0].field).to.eql(\"password\");\r",
									"  pm.expect(error.errors[0].params.max).to.eql(20);\r",
									"});"
								],
								"type": "text/javascript",
								"id": "e4530a13-0499-4f02-a731-b6c2cc4f2cfa"
							}
						}
					],
					"id": "dd45af5c-c828-492b-9292-5ce26f64fef0",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"password\": \"qwertyuiopasdfghjklzxcv\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/account/password",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"account",
								"password"
							]
						}
					},
					"response": []
				},
				{
					"name": "Password change (success)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"const reqData = JSON.parse(request.data);\r",
									"console.log(JSON.parse(request.data));\r",
									"pm.environment.set(\"pass\", reqData.password);\r",
									"\r",
									"const response = pm.response.json();\r",
									"\r",
									"pm.test(\"Password change successful\", () => {\r",
									"  pm.expect(response.id).to.eql(3001445);  \r",
									"  pm.expect(response.email).to.eql(\"deminaon@gmail.com\");\r",
									"  pm.expect(response.username).to.eql(\"Oksana\");\r",
									"  pm.expect(response.accounts).to.be.empty;\r",
									"  pm.expect(response.isVerified).to.be.true;\r",
									"  pm.expect(response.verifyEmail).to.be.null;\r",
									"  pm.expect(response.verificationKey).to.eql(\"187571a1q0\");\r",
									"});"
								],
								"type": "text/javascript",
								"id": "2583ce69-1cf0-49c2-a8ff-ccf31c6bf959"
							}
						}
					],
					"id": "fedaf2c0-04b8-4e0e-a548-be34999f42d4",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"password\": \"{{$randomPassword}}\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/account/password",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"account",
								"password"
							]
						}
					},
					"response": []
				},
				{
					"name": "Login (new password)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"id": "c3f3e315-b8f4-4f1f-9682-7762eb91f3df"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"const response = pm.response.json()\r",
									"    \r",
									"pm.test (\"Login success\", () => {\r",
									"  pm.expect(response.email).to.eql(\"deminaon@gmail.com\");\r",
									"  pm.expect(response.username).to.eql(\"Oksana\");\r",
									"});"
								],
								"type": "text/javascript",
								"id": "c6f0f282-7e90-4f6d-9dc5-e2cc6e82e06b"
							}
						}
					],
					"id": "06115070-167d-4f85-b933-1de159eaff0e",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"email\": \"Deminaon@gmail.com\",\r\n    \"password\": \"{{pass}}\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/login?redirect=%2F",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"login"
							],
							"query": [
								{
									"key": "redirect",
									"value": "%2F"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Password change (revert)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {\r",
									"  pm.response.to.have.status(200);\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"id": "12309819-4956-4e71-a0bd-1ecdb933cf12"
							}
						}
					],
					"id": "b236da90-02a8-4e62-891d-48a9feabf5be",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"password\": \"qwerty123\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/api/account/password",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"account",
								"password"
							]
						}
					},
					"response": []
				}
			],
			"id": "ae1c1fa6-0591-428f-bfa9-2012e8bafdba"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				],
				"id": "b9744d58-b225-4a10-8051-5f7102d4c9d7"
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				],
				"id": "f16130a1-dc78-4271-b9e2-2abd3040aff5"
			}
		}
	]
}